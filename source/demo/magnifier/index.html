<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>放大镜效果</title>
<style>
*{margin: 0; padding: 0;}
#wrap{width: 1200px; margin: 20px auto;}
#small_box,#mark,#small_box img{width: 320px; height: 240px;}
#small_box{padding: 10px; margin-right: 20px; border: 1px solid #ccc; float: left; position: relative;}
#small_box img{border: none;}
#mark,#float{position: absolute; left: 0; top: 0;}
#mark{width: 340px; height: 260px; background: rgba(0,0,0,.0); z-index: 5;}
#float{width: 80px; height: 80px; background: #f00; opacity: 0.5; filter: alpha(opacity=50); display: none;}
#big_box{width: 400px; height: 400px; padding: 10px; float: left; border: 1px solid #ccc; overflow: hidden; position: relative; display: none;}
#big_box img{position: absolute; z-index: 2;}
</style>
<script>
function g(sel){
	return document.getElementById(sel);
}
window.onload = function(){
	var oSmallBox = g('small_box');
	var oMark = g('mark');
	var oFloat = g('float');
	var oSmallImg = oSmallBox.getElementsByTagName('img')[0];
	var oBigBox = g('big_box');
	var oBigImg = oBigBox.getElementsByTagName('img')[0];

	oMark.onmouseover = function(){
		oFloat.style.display = 'block';
		oBigBox.style.display = 'block';
	}
	oMark.onmouseout = function(){
		oFloat.style.display = 'none';
		oBigBox.style.display = 'none';
	}
	oMark.onmousemove = function(ev){
		var oFloatW = oFloat.offsetWidth;
		var oFloatH = oFloat.offsetHeight;
		var oSmallBoxW = oSmallBox.offsetWidth;
		var oSmallBoxH = oSmallBox.offsetHeight;
		var oBigBoxW = oBigBox.offsetWidth;
		var oBigBoxH = oBigBox.offsetHeight;

		var ev = ev || event;
		var left = ev.clientX - oSmallBox.offsetLeft -  oFloatW/2;
		var top = ev.clientY - oSmallBox.offsetTop -  oFloatH/2;

		if(left < 0 ){
			left = 0;
		}else if(left > oSmallBoxW - oFloatW){
			left = oSmallBoxW - oFloatW;
		}
		if(top < 0){
			top = 0;
		}else if(top > oSmallBoxH - oFloatH){
			top = oSmallBoxH - oFloatH;
		}

		oFloat.style.left = left + 'px';
		oFloat.style.top = top + 'px';

		var percentX = left / (oSmallBoxW - oFloatW);
		var percentY = top / (oSmallBoxH - oFloatH);
		
		oBigImg.style.left = -percentX * (oBigImg.offsetWidth - oBigBoxW) + 'px';
		oBigImg.style.top = -percentY * (oBigImg.offsetHeight - oBigBoxH) + 'px';
	}
}
</script>
</head>
<body>
	<div id="wrap">
		<div id="small_box">
			<div id="mark"></div>
			<div id="float"></div>
			<img src="s1.jpg" alt="">
		</div>
		<div id="big_box">
			<img src="b1.jpg" alt="">
		</div>
	</div>
</body>
</html>