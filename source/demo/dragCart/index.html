<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>拖拽到购物车购买商品</title>
	<style>
	body,ul,span,p{margin:0; padding: 0;}
	li{list-style: none; }
	#wrap{width: 848px; margin:20px auto; }
	#list{width:100%; float: left; }
	#list ul li{width:200px;  margin-right: 10px; float:left;border:1px dashed #ccc; background: #f0f0f0; }
	#list ul li img{}
	#list ul li span{float: right; height: 30px; line-height: 30px; padding-right: 20px; color: #f30; font-weight: 700; display: inline-block;}
	#list ul li p{text-align: center; height: 30px; line-height: 30px;}
	#cart{width:818px; height:200px; border:1px solid #ccc;  float: left; padding:10px ; margin-top: 20px; position: relative;}
	#cart p{border-bottom: 1px dashed #ccc; height: 30px; line-height: 30px;}
	#cart p span{height: 30px; line-height: 30px; margin-right: 20px;}
	#cart  .number{width: 20px; }
	#cart  .title{width: 500px;  padding-left: 50px;}
	#cart  .price{width: 120px; float:right; }
	#allMoney{width:818px; height:30px; text-align: right; padding-right: 20px; position: absolute; bottom:0; left:0;}
	</style>
	<script>
	window.onload = function(){
		var oDiv = document.getElementById('list');
		var aLi = oDiv.getElementsByTagName('li');
		var oCart = document.getElementById('cart');
		var obj = {};
		var totalMoney = null;
		var num = 0;
		for (var i = 0; i < aLi.length; i++) {
			aLi[i].draggable = true;

			//拖拽开始
			aLi[i].ondragstart = function(){
				var aP = this.getElementsByTagName('p')[0];
				var aSpan = this.getElementsByTagName('span')[0];
				
				var ev = ev || event;
				ev.dataTransfer.setData('name',aP.innerHTML);
				ev.dataTransfer.setData('money',aSpan.innerHTML);
			}
			// 过拽经过
			oCart.ondragover = function(ev){
				var ev =  ev || event;
				ev.preventDefault();

			}
			// 释放
			oCart.ondrop = function(ev){
				var ev = ev || event;

				var oTitle = ev.dataTransfer.getData('name');
				var oMoney = ev.dataTransfer.getData('money');

				if( !obj[oTitle]){
					var oP = document.createElement('p');
					var oNum = document.createElement('span');
					oNum.innerHTML = 1;
					oNum.className = 'number';
					oP.appendChild(oNum);
					
					var oName = document.createElement('span');
					oName.innerHTML = oTitle;
					oName.className = 'title';
					oP.appendChild(oName);
					
					var oPrice = document.createElement('span');
					oPrice.innerHTML = oMoney;
					oPrice.className = 'price';
					oP.appendChild(oPrice);

					oCart.appendChild(oP);
					obj[oTitle] = 1;
				}else{
					var oBook1 = document.getElementsByClassName('number');
					var oBook2 = document.getElementsByClassName('title');

					for (var i = 0; i < oBook1.length; i++) {
						if(oBook2[i].innerHTML == oTitle){
							oBook1[i].innerHTML = parseInt(oBook1[i].innerHTML )+ 1;
						}
					};
				}
				if( ! totalMoney ){
					totalMoney = document.createElement('div');
					totalMoney.id = 'allMoney'; 
				}
				num  +=  parseFloat(oMoney)*100;
				totalMoney.innerHTML = (num /100) + '元';
				oCart.appendChild(totalMoney);
			}
		};
	}
	</script>
</head>
<body>
<div id="wrap">
	<div id="list">
		<ul>
			<li>	
				<img src="img/1.jpg" alt="">
				<p>大秦帝国</p>
				<span>98.5元</span>
			</li>
			<li>	
				<img src="img/1.jpg" alt="">
				<p>疯狂的投资</p>
				<span>34.5元</span>
			</li>
			<li>	
				<img src="img/1.jpg" alt="">
				<p>经济学原理</p>
				<span>48元</span>
			</li>
			<li>	
				<img src="img/1.jpg" alt="">
				<p>天堂茶话</p>
				<span>64元</span>
			</li>
		</ul>	
	</div>

	<div id="cart">
		<!-- <p>
			<span class="number">1</span>
			<span class="title">疯狂的投资</span>
			<span class="price">13.5￥</span>
		</p>
		<div id="allMoney"></div> -->
	</div>
</div>
</body>
</html>