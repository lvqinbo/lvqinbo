<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>事件委托</title>
<style>
body{font-family: monospace;}
#wrap{width: 960px; border: 1px solid #ddd; margin: 20px auto;}
#wrap p{padding-left: 20px;}
#wrap input{outline: none; border: 1px solid #ddd; padding: 2px 5px;}
#ul1{list-style: none; padding: 10px 0; margin: 0;}
#ul1 li{padding-left: 20px; line-height: 24px;}
</style>
<link rel="stylesheet" href="../../code.css">
<script src="../../ajax.js"></script>
<script src="../../readcode.js"></script>
<script>
window.onload = function(){
	var oCodeList = getByClass(document,'codelist')[0];
	readCode('事件委托.js',oCodeList);
	var oUl = document.getElementById('ul1');
	var aLi = oUl.getElementsByTagName('li');
	var oWrap = document.getElementById('wrap');
	var aInput = oWrap.getElementsByTagName('input');
	
	// 普通的写法，给每个li加事件，如果li比较多，性能会差
	/*for (var i = 0; i < aLi.length; i++) {
		aLi[i].onmouseover = function(){
			this.style.background = 'red';
		}

		aLi[i].onmouseout = function(){
			this.style.background = '';
		}
	};*/
	// 事件委托，通过委托ul来给li加事件
	oUl.onmouseover = function(ev){
		var ev = ev || event;
		var target = ev.target || ev.srcElement;
		if(target.nodeName.toLowerCase() == 'li'){
			target.style.background = '#f0f0f0';
		}
	}
	oUl.onmouseout = function(ev){
		var ev = ev || event;
		var target = ev.target || ev.srcElement;
		if(target.nodeName.toLowerCase() == 'li'){
			target.style.background = '';
		}
	}
	// 通过事件委托，动态创建的元素同样拥有之前元素的事件
	aInput[1].onclick = function(){
		fnCreateLi();
	}
	document.onkeydown = function(ev){
		var ev = ev || event;
		if(ev.keyCode == 13){
			fnCreateLi();
		}
	}

	function fnCreateLi(){
		var oLi = document.createElement('li');
		oLi.innerHTML = aInput[0].value;
		oUl.insertBefore(oLi,aLi[0]);
	}
}
</script>
</head>
<body>
	<div id="wrap">
		<p>
			<input type="text">
			<input type="button" value="创建">
		</p>
		<ul id="ul1">
			<li>hello man! good morning!</li>
			<li>hello man! good morning!</li>
			<li>hello man! good morning!</li>
			<li>hello man! good morning!</li>
			<li>hello man! good morning!</li>
		</ul>
	</div>
	<div class="codebox"><pre><ol class="codelist"></ol></pre></div>
</body>
</html>