<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>拖拽上传文件</title>
	<style>
	img{border: none;}
	a{text-decoration: none; color: #fff;}
	#wrap{width: 500px;  margin: 50px auto;}
	#box{width: 500px; height: 300px; line-height: 300px; color: #ccc; border: 1px solid #f0f0f0; text-align: center; box-shadow: 0 0 5px #ccc;}
	#imgbox{width: 500px;}
	.picnum{width: 500px; display: none;}
	#imgbox .pic{width: 116px; padding: 2px; margin-right: 2px; border: 1px solid #f1f1f1; position: relative; float: left;}
	#imgbox .pic img{width: 120px; opacity: 0.6; z-index: 1;}
	#imgbox .pic img:hover{opacity: 1;}
	#imgbox a{width: 30px; height: 20px; line-height: 15px; text-align: center; display: inline-block; position: absolute; right:0; top: 2px; background: rgba(0,0,0,.4); z-index: 2;}
	</style>
	<script>
	window.onload = function(){
		var oBox = document.querySelector('#box');
		var oImgBox = document.querySelector('#imgbox');
		var oP = document.querySelector('.picnum');
		var html = '',num = 0;
		
		oBox.ondragover = function(ev){
			var ev = ev || event;
			ev.preventDefault();
			oBox.innerHTML = '可以释放了！';
		}
		oBox.ondragleave = function(ev){
			oBox.innerHTML = '请将文件拖拽到此区域';
		}
		oBox.ondrop = function(ev){
			var ev = ev || event;
			ev.preventDefault();
			oBox.innerHTML = '请将文件拖拽到此区域';
			
			var fin = ev.dataTransfer.files;
			// console.log(fin[0].type);
			
			for (var i = 0; i < fin.length; i++) {
				if(fin[i].type.indexOf('image') != -1){

					// 创建读取文件对象
					var fr = new FileReader();
					fr.readAsDataURL( fin[i] );

					fr.onload = function(){
						
						oImgBox.innerHTML += '<div class="pic"><img src="'+this.result+'" /><a href="javascript:;">x</a></div>';
						num++;
						console.log(num)
						var aClose = oImgBox.getElementsByTagName('a');
						for (var i = 0; i < aClose.length; i++) {
							aClose[i].onclick = function(){
								this.parentNode.parentNode.removeChild(this.parentNode);
								num--;
								console.log(num)
								oP.innerHTML = num+'/8';
								if(num == 0){
									oP.style.display = 'none';
								}
							}
						};
					}
				}
			};
			oP.style.display = 'block';
			oP.innerHTML = num+1+'/8';
		}
	}
	</script>
</head>
<body>
	<div id="wrap">
		<div id="box">
			请将文件拖拽到此
		</div>
		<p class="picnum">0/8</p>
		<div id="imgbox"></div>
	</div>
</body>
</html>