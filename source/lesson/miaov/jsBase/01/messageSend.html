<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>模拟短息发送</title>
	<style>
	ul{margin: 0; padding: 0; list-style: none;}
	img{border: none;}
	a{text-decoration: none;}
	input{outline: none;}
	body{background: #fff; font: 14px/1.2em "微软雅黑"; color: #333;}
	
	#box{width: 600px; box-shadow: 0 0 2px #999; margin: 20px auto;}
	.msg{width: 100%; height: 360px; overflow: hidden;}
	.msg li{max-width: 400px; width: 100%; position: relative; padding: 0 50px; margin-top: 10px;}
	.msg li img{position: absolute; top: 0;}
	.msg li span{display: inline-block; padding: 10px; color: #fff;}
	
	.msg li.left{float: left;}
	.msg li.right{float: right;}
	.msg li.left img{left: 10px;}
	.msg li.right img{right: 10px;}
	.msg li.left span{padding-left: 10px; background: #880fca;}
	.msg li.right span{float: right; padding-right: 10px; background: gray;}

	.control{height: 50px; line-height: 50px; background: #ddd;}
	.control img{left: 10px; top: 10px; position: relative;}
	.control input{width: 400px; padding: 7px 3px; margin-left: 25px; border: none; border: 1px solid #ccc;}
	.control a{width: 80px; height: 30px; line-height: 30px; margin: 10px; background: #999; color: #fff; text-align: center;  display: inline-block;}
	</style>
	<script>
	window.onload = function(){
		
		var oBox = document.getElementById('box');
		var oUl = getByClass(oBox,'msg')[0];	
		var oControl = getByClass(oBox,'control')[0];
		var oSend = oControl.getElementsByTagName('a')[0];
		var oInp = oControl.getElementsByTagName('input')[0];
		var oHead = oControl.getElementsByTagName('img')[0];
		
		var iBtn = true;
		var html = '';
		//点击切换头像
		oHead.onclick = function(){
			this.src = iBtn > 0 ? 'small2.jpg' : 'small.jpg';
			iBtn = !iBtn;
		}
		//鼠标点击发送信息
		oSend.onclick = fnSend;
		//键盘按下回车发送信息
		document.onkeydown = function(ev){
			var ev = ev || event;
			if( ev.keyCode == 13 ){
				fnSend();
			}
		}
		//发送信息函数
		function fnSend(){
			var sClass = '';
			sClass = iBtn > 0 ? 'left' : 'right';
			var re = /^\s/;
			if( oInp.value == '' || re.test(oInp.value) ){
				alert('请输入要发送的内容！');
				return;
			}
			html = '<li class="'+sClass+'">\
					<img src="'+oHead.src+'" alt="haha"><span>'+oInp.value+'</span></li>' + html;

			oUl.innerHTML = html;
			oInp.value = '';
		}
	}
	function getByClass(oParent,sClass){
		var result = [];
		var eles = oParent.getElementsByTagName('*');
		for (var i = 0; i < eles.length; i++) {
			if(eles[i].className == sClass){
				result.push(eles[i]);
			}
		};
		return result;
	}
	</script>
</head>
<body>
	<div id="wrap">
		<div id="box">
			<ul class="msg">
				
			</ul>
			<div class="control">
				<img src="small.jpg" alt="">
				<input type="text">
				<a href="javascript:;">发送</a>
			</div>
		</div>
	</div>
</body>
</html>