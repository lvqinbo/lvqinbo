<!DOCTYPE HTML>
<html>

<head>
    
    <meta name="viewport" content="width=device-width,initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no,minimal-ui">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <title>eye+房产VR系统</title>
    <link rel="stylesheet" href="vr_main.css">
    <link rel="stylesheet" href="fonts/iconfont.css">
    <script src="base.js"></script>
    <script>
    window.onload = function() {
        var oBannerWrap = g('banner-hx');
        var oList = g('pic-list');
        // var aListLi = oList.getElementsByTagName('li');
        // var aNavLi = oBannerWrap.getElementsByTagName('nav')[0].children;
        var oBtnPrev = g('banner-btn-prev');
        var oBtnNext = g('banner-btn-next');

        var oLpListWrap = g('lp-list-wrap');
        var aLpListItem = oLpListWrap.getElementsByTagName('li');
        var downX,downLeft,iX = 0;
        var iW = view().w;

        for(var i = 0, l = aLpListItem.length; i < l; i++){
            aLpListItem[i].style.width = view().w/3 + 'px';
        }
        oLpListWrap.style.width = aLpListItem[0].offsetWidth * aLpListItem.length + 'px';

        bind(oLpListWrap,'touchstart',fnDragStart);
        bind(oLpListWrap,'touchmove',fnDragMove);
        bind(oLpListWrap,'touchmove',fnDragEnd);

        var imgFull = (function(){
            var oPart = g('apart-layer');
            var aImg = getByClass(oPart,'min');
            var iBtn = true;
            var iNum = 0;
            var oTimer = null;
            var iTop = 0;
            var downY = 0;


            for(var i = 0; i < aImg.length; i++){
                
                bind(aImg[i],'touchstart',fnTouchDown)

            }
                function fnTouchDown(ev){
                    var touch = ev.changedTouches[0];
                    downY = touch.pageY;
                    var oT = new Date();

                    console.log(oT.getTime());

                    // if(downY < touch.pageY || downY > touch.pageY && )
                }

            function fnFullImg (src){
                var _src = src;
                
                if(iBtn){
                    iBtn = false;
                    var oNewImgWin = document.createElement('div');
                    oNewImgWin.id = 'imgWrap';
                    oNewImgWin.className = 'imgWrap';
                    oNewImgWin.innerHTML = '<img src="'+_src+'" class="newImg" /><span id="close-btn">×</span>';
                    document.body.appendChild(oNewImgWin);

                    var oNewImgWin = g('imgWrap');
                    var oClose = g('close-btn');
                    oNewImgWin.style.top = document.body.scrollTop + 'px';
                }else{
                    var oNewImgWin = g('imgWrap');
                    var oClose = g('close-btn');
                    var oImg = oNewImgWin.getElementsByTagName('img')[0];
                    oNewImgWin.style.top = document.body.scrollTop + 'px';
                    oNewImgWin.style.display = 'block';
                    oImg.src = _src;
                }
                bind(oClose,'touchstart',function(){
                    oNewImgWin.style.display = 'none';
                });
            }
        })();


        function fnDragStart(ev){
            var touchs = ev.changedTouches[0];
            downX = touchs.pageX;
            downLeft = iX;
        }
        function fnDragMove(ev){
            var touchs = ev.changedTouches[0];
            var disX = touchs.pageX - downX;
            iX = downLeft + disX;
            if(iX > 0){
                iX = 0;
            }else if( iX <= (iW - oLpListWrap.offsetWidth) ){
                iX = (iW - oLpListWrap.offsetWidth);
            }
            oLpListWrap.style.transition = '.3s';
            oLpListWrap.style.WebkitTransform = 'translateX('+iX+'px)';
        }

        function fnDragEnd(){
            oLpListWrap.style.transition = '';
        }


        // function init() {
        //     for (var i = 0, l = aListLi.length; i < l; i++) {
        //         aListLi[i].style.width = view().w + 'px';
        //     }
        //     oList.style.width = aListLi[0].offsetWidth * aListLi.length + 'px';
        // }
        // init();

        fnTab();

        function fnTab() {
            var iNow = 0;
            var iX = 0;
            var iW = view().w;
            var oTimer = 0;
            var iStartTouchX = 0;
            var iStartX = 0;

            bind(oBannerWrap, "touchstart", fnStart);
            bind(oBannerWrap, "touchmove", fnMove);
            bind(oBannerWrap, "touchend", fnEnd);

            auto();

            function auto() {
                oTimer = setInterval(function() {
                    iNow++;
                    iNow = iNow % aNavLi.length;
                    tab();
                }, 2000);
            }

            function tab() {
                iX = -iNow * iW;
                oList.style.transition = "0.5s";
                oList.style.WebkitTransform = oList.style.transform = "translateX(" + iX + "px)";
                for (var i = 0; i < aNavLi.length; i++) {
                    removeClass(aNavLi[i], "active");
                }
                addClass(aNavLi[iNow], "active");
            }

            function fnStart(ev) {
                oList.style.transition = "none";
                var ev = ev.changedTouches[0];
                iStartTouchX = ev.pageX;
                iStartX = iX;
                clearInterval(oTimer);

            }

            function fnMove(ev) {
                var ev = ev.changedTouches[0];
                var iDis = ev.pageX - iStartTouchX;
                iX = iStartX + iDis;
                oList.style.WebkitTransform = oList.style.transform = "translateX(" + iX + "px)";
            }

            function fnEnd() {
                iNow = iX / iW;
                iNow = -Math.round(iNow);
                if (iNow < 0) {
                    iNow = 0;
                }
                if (iNow > aNavLi.length - 1) {
                    iNow = aNavLi.length - 1;
                }
                tab();
                auto();
            }

            function tab() {
                iX = -iNow * iW;
                oList.style.transition = "0.5s";
                oList.style.WebkitTransform = oList.style.transform = "translateX(" + iX + "px)";
                for (var i = 0; i < aNavLi.length; i++) {
                    removeClass(aNavLi[i], "active");
                }
                addClass(aNavLi[iNow], "active");
            }
        }

    }
    </script>
</head>

<body>
    <div id="g-wrap" class="details-wrap">
        <div class="top-img"></div>
        <div class="contact-info">
            <p><i class="iconfont icon-money"></i>均价：5600元/㎡</p>
            <p><i class="iconfont icon-location"></i>地址：叠彩区中山北路112号</p>
            <p><i class="iconfont icon-tel"></i>电话：<a href="tel:400-6356-888">400-6356-888</a></p>
        </div>
        <div class="lp-list">
            <ul id="lp-list-wrap">
                <li class="lp-list-item"><img src="img/list1.jpg" alt=""></li>
                <li class="lp-list-item"><img src="img/list2.jpg" alt=""></li>
                <li class="lp-list-item"><img src="img/list3.jpg" alt=""></li>
                <li class="lp-list-item"><img src="img/list4.jpg" alt=""></li>
                <li class="lp-list-item"><img src="img/list5.jpg" alt=""></li>
                <li class="lp-list-item"><img src="img/list6.jpg" alt=""></li>
                <li class="lp-list-item"><img src="img/list7.jpg" alt=""></li>
                <li class="lp-list-item"><img src="img/list8.jpg" alt=""></li>
            </ul>
        </div>
        <!-- <div class="banner-hx" id="banner-hx">
            <ul class="banner-hx-list" id="pic-list">
                <li><img src="img/c1.jpg" alt=""></li>
                <li><img src="img/c2.jpg" alt=""></li>
                <li><img src="img/c3.jpg" alt=""></li>
                <li><img src="img/c4.jpg" alt=""></li>
            </ul>
            <nav>
                <a href="javascript:;" class="active"></a>
                <a href="javascript:;"></a>
                <a href="javascript:;"></a>
                <a href="javascript:;"></a>
            </nav>
        </div> -->
        <div class="apart-layout" id="apart-layer">
            <ul>
                <li>
                    <div class="apart-list-inner">
                        <div class="apart-img-box">
                            <img class="min" src="img/hx_a.jpg" alt="">
                        </div>
                        <p class="hx-name">1房1厅1卫（45平方）</p>
                        <span class="label-vr">vr</span>
                    </div>
                </li>
                <li>
                    <div class="apart-list-inner">
                        <div class="apart-img-box">
                            <img class="min" src="img/hx_b.jpg" alt="">
                        </div>
                        <p class="hx-name">2房2厅1卫（93平方）</p>
                        <span class="label-vr">vr</span>
                    </div>
                </li>
                <li>
                    <div class="apart-list-inner">
                        <div class="apart-img-box">
                            <img class="min" src="img/hx_c.jpg" alt="">
                        </div>
                        <p class="hx-name">3房2厅2卫（108平方）</p>
                        <span class="label-vr">vr</span>
                    </div>
                </li>
                <li>
                    <div class="apart-list-inner">
                        <div class="apart-img-box">
                            <img class="min" src="img/hx_d.jpg" alt="">
                        </div>
                        <p class="hx-name">2房1厅1卫（79平方）</p>
                        <span class="label-vr">vr</span>
                    </div>
                </li>
            </ul>
        </div>
        <div class="form-bt">
            <form action="">
                <input type="tel" placeholder="手机号码">
                <input type="text" placeholder="称呼">
                <button class="form-btn">登记</button>
            </form>
        </div>
    </div>
</body>

</html>
