<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=devie-width,initial-scale=1.0,user-scalable=no">
<title>微信场景2</title>
<style>
body{font-family:Tahoma,Arial,Roboto,"Droid Sans","Helvetica Neue","Droid Sans Fallback","Heiti SC",sans-self; font-size: 16px; background: #333; color: #333;}
li{list-style: none;}
html{overflow: hidden;}
*{margin: 0; padding: 0;}
/*主体*/
#main{width: 640px; height: 1008px; position: absolute; left: 50%; top: 0; margin-left: -320px; z-index: -1; -webkit-transform-origin: top; transform-origin: top; }
/*电话区域*/
#phone{width: 100%; height: 100%; background: url(img/phoneBg.jpg)no-repeat; position: absolute; left: 0; top: 0; z-index: 10; overflow: hidden; transition: .5s;}
#phoneHeader{position: absolute; left: 50%; margin-left: -131px; top: 10%;}
#phoneHeader .phoneHeadBtn{width: 262px; height: 115px; background: url(img/phoneHeadName.png)no-repeat;}
#phoneHeader .phoneHeaderText{font-size: 30px; color: #fff; text-align: center; margin-top: 30px;}
#phoneBtn{width: 520px; height: 360px; background: url(img/phoneBtn.png)no-repeat; position: absolute; bottom: 30px; left: 50%; margin-left: -260px;}
#phoneBtn .phoneBtnArc{width: 170px; height: 170px; border: 3px solid #0f0; border-radius: 50%; position: absolute; left: 358px; top: 144px; -webkit-animation: phoneAreMove 1s linear infinite; animation: phoneAreMove 1s linear infinite; z-index: -1;}
#phoneBtn .phoneBtnTouch{width: 150px; height: 150px; background: rgba(0,0,0,0); position: absolute; left: 370px; top: 156px; border-radius: 50%;}
#phoneKeyborad{width: 520px; height: 659px; background: url(img/phoneKey.png)no-repeat; position: absolute; left: 50%; margin-left: -260px; bottom: 30px; -webkit-transform: translate(0,689px); transform: translate(0,689px); -webkit-transition: 1s; transition: 1s;}
#phoneKeyborad .phoneKeyClose{width: 170px; height: 170px; border-radius: 50%; position: absolute; left: 50%; margin-left: -85px; bottom: 30px; background: rgba(0,0,0,0);}
/*消息区域*/
#message{width: 100%; height: 100%; background: #fff; position: absolute; top: 0; left: 0; z-index: 9; overflow: hidden; transition: .5s;}
#messageList{width: 100%; position: absolute; top: 20px; box-sizing: border-box; -webkit-transition: .5s; transition: .5s;}
#messageList li{max-width: 360px; font-size: 36px; line-height: 40px; margin-bottom: 30px; position: relative; clear: both; padding: 20px; border-radius: 15px; -webkit-transition: .5s; transition: .5s; opacity: 0; -webkit-transform: translate(0,150px);}
#messageList li.sty1{background: #fff; border: 2px solid #cacaca; float: left; left: 125px;}
#messageList li.sty2{background: #a2e45c; border: 2px solid #96b474; float: right; right: 125px;}

#messageList li.sty1::before,#messageList li.sty2::before{content: ""; width: 0; height: 0; border: 15px solid green; top: 50%; margin-top: -20px; position: absolute;}
#messageList li.sty1::after,#messageList li.sty2::after{content: ""; width: 0; height: 0; border: 15px solid #fff; top: 50%; margin-top: -20px; position: absolute;}

#messageList li.sty1::before{border-color: transparent #cacaca transparent transparent; left: -32px;}
#messageList li.sty1::after{border-color: transparent #fff transparent transparent; left: -29px;}
#messageList li.sty2::before{border-color: transparent transparent transparent #96b474; right: -32px;}
#messageList li.sty2::after{border-color: transparent transparent transparent #a2e45c; right: -29px;}

#messageList li img{position: absolute; top: 0;}
#messageList li.sty1 img{left: -100px;}
#messageList li.sty2 img{right: -100px;}
#messageText{width: 640px; height: 88px; background: url(img/messageText.png)no-repeat; position: absolute; bottom: 0;}

/*魔方*/
#cube{width: 100%; height: 100%; position: absolute; left: 0; top: 0; background: url(img/cubeBg.jpg)no-repeat; background-size: cover; -webkit-perspective: 800px; perspective: 800px; z-index: 6;}
/*音乐图标*/
#musicIcon{width: 70px; height: 70px; position: absolute; left: 42px; top: 20px; background: url(img/music.png)no-repeat; z-index: 7; background-size: cover; }
#musicIcon.active{-webkit-animation: musicMove 1s linear infinite; animation: musicMove 1s linear infinite;}
/*魔方的各个面*/
#cubeList{width: 510px; height: 510px; position: absolute; left: 50%; top: 30%; margin-left: -260px; -webkit-transform-style: -webkit-preserve-3d; -webkit-transform: scale(0) rotateX(-45deg) rotateY(-180deg); transform-style: preserve-3d; transform: scale(0) rotateX(-45deg) rotateY(-180deg); transform-origin: 255px 255px -255px;}
#cubeList li{width: 510px; height: 510px; position: absolute; }
#cubeList li:nth-of-type(1){background: url(img/cubeImg1.png)no-repeat; left: 0; top: 0;}
#cubeList li:nth-of-type(2){background: url(img/cubeImg2.png)no-repeat; left: 510px; top: 0; -webkit-transform: rotateY(90deg); -webkit-transform-origin: left; transform: rotateY(90deg); transform-origin: left;}
#cubeList li:nth-of-type(3){background: url(img/cubeImg3.png)no-repeat; left: 0; top: 0; -webkit-transform: translateZ(-510px) rotateY(180deg); transform: translateZ(-510px) rotateY(180deg);}
#cubeList li:nth-of-type(4){background: url(img/cubeImg4.png)no-repeat; right: 510px; top: 0; -webkit-transform: rotateY(-90deg); -webkit-transform-origin: right; transform: rotateY(-90deg); transform-origin: right;}
#cubeList li:nth-of-type(5){background: url(img/cubeImg5.png)no-repeat; left: 0; top: -510px; -webkit-transform: rotateX(90deg); -webkit-transform-origin: bottom; transform: rotateX(90deg); transform-origin: bottom;}
#cubeList li:nth-of-type(6){background: url(img/cubeImg6.png)no-repeat; left: 0; top: 510px; -webkit-transform: rotateX(-90deg); -webkit-transform-origin: top; transform: rotateX(-90deg); transform-origin: top;}
#cubeTip{width: 394px; height: 44px; background: url(img/cubeTip.png)no-repeat; position: absolute; left: 50%; bottom: 50px; margin-left: -197px;}
#cubeShare{width: 62px; height: 62px; background: url(img/cubeShare.png)no-repeat; position: absolute; top: 10px; right: 20px;}
#cubeShareMark{width: 100%; height: 100%; position: absolute; left: 0; top: 0; background: rgba(0,0,0,.8); text-align: center; display: none;}

/*点击魔方显示的详细内容*/
#details{width: 100%; height: 100%; position: absolute; left: 0; top: 0; z-index: 5; display: none;}
#detailsList{width: 100%; height: 100%; -webkit-transform-style: preserve-3d; -webkit-perspective: 800px; transform-style: preserve-3d; perspective: 800px;}
#detailsList li{width: 100%; height: 100%; position: absolute; left: 0; top: 0; visibility: hidden;}
#detailsList li:nth-child(1){background: #5cb2a9;}
#detailsList li:nth-child(2){background: #ff7777;}
#detailsList li:nth-child(3){background: #fbffe6;}
#detailsList li:nth-child(4){background: #e5fff4;}
#detailsList li:nth-child(5){background: #fff;}
#detailsList li:nth-child(6){background: #5974ff;}

/*点击魔方显示的详细内容--淡入淡出效果*/
#detailsList li.fadeIn{-webkit-animation: detailsFadeIn .5s; animation: detailsFadeIn .5s; visibility: visible;}
#detailsList li.fadeOut{-webkit-animation: detailsFadeOut .3s; animation: detailsFadeOut .3s; visibility: hidden;}
/*点击魔方显示的详细内容左右切换页面效果*/
#detailsList li.leftShow{-webkit-animation: detailsLeftShow 1s; animation: detailsLeftShow 1s; visibility: visible; z-index: 10;}
#detailsList li.rightHide{-webkit-animation: detailsRightHide 1s; animation: detailsRightHide 1s; visibility: hidden;}
#detailsList li.rightShow{-webkit-animation: detailsRightShow 1s; animation: detailsRightShow 1s; visibility: visible; z-index: 10;}
#detailsList li.leftHide{-webkit-animation: detailsLeftHide 1s; animation: detailsLeftHide 1s; visibility: hidden;}

/*点击魔方显示详细页面--图片*/
#detailsList .detailsImg{width: 100%; position: absolute; left: 50%; top: 10%;}
#detailsList .detailsImg img{position: absolute; left: 0; top: 0; opacity: 0;}
#detailsList li:nth-of-type(1) .detailsImg{width: 510px; height: 423px; margin-left: -255px;}
#detailsList li:nth-of-type(2) .detailsImg{width:374px; height: 374px; margin-left: -187px; background: white; border-radius: 50%;}
#detailsList li:nth-of-type(3) .detailsImg{width: 386px; height: 336px; margin-left: -193px;}
#detailsList li:nth-of-type(4) .detailsImg{width: 259px; height: 306px; margin-left: -130px;}
#detailsList li:nth-of-type(5) .detailsImg{width: 221px; height: 284px; margin-left: -110px;}
#detailsList li:nth-of-type(6) .detailsImg{width: 478px; height: 419px; margin-left: -239px;}

/*点击魔方显示详细页面--文字介绍*/
#detailsList li .detailsText{ width: 100%; position: absolute; bottom: 10%;}
#detailsList li:nth-of-type(1) .detailsText{ background: url(img/detailText1.png) no-repeat; height: 240px;}
#detailsList li:nth-of-type(2) .detailsText{ background: url(img/detailText2.png) no-repeat; height: 400px;}
#detailsList li:nth-of-type(3) .detailsText{ background: url(img/detailText3.png) no-repeat; height: 300px;}
#detailsList li:nth-of-type(4) .detailsText{ background: url(img/detailText4.png) no-repeat; height: 300px;}
#detailsList li:nth-of-type(5) .detailsText{ background: url(img/detailText5.png) no-repeat; height: 400px;}
#detailsList li:nth-of-type(6) .detailsText{ background: url(img/detailText6.png) no-repeat; height: 260px;}
/*点击魔方显示详细页面的--列表的小点*/
#detailsDot{width: 100%; position: absolute; bottom: 30px; text-align: center; }
#detailsDot span{width: 15px; height: 15px; margin-right: 5px; background: rgba(0,0,0,.3); border-radius: 50%; display: inline-block;}
#detailsDot span.active{background: #666;}

/*点击魔方显示详细信息页面--返回图标*/
#detailsReturn{width: 65px; height: 76px; background: url(img/detailsReturn.png)no-repeat; position: absolute; top: 10px; right: 20px;}

/*加载进度条页面*/
#loading{width: 100%; height: 100%; position: absolute; top: 0; left: 0; z-index: 20; background: #000;}
#loading .loadingProgressBox{width: 460px; height: 30px; background: #fff; position: absolute; left: 50%; top: 45%; margin-left: -230px; border-radius: 15px;}
#loading .loadingProgressBar{width: 0; height: 100%; background: #5cb85c; border-radius: 15px; background-image: -webkit-linear-gradient(-45deg,#5cb85c 25%, #74c274 25%, #74c274 50%, #5cb85c 50%, #5cb85c 75%, #74c274 75%); background-size: 40px 40px; -webkit-animation: loadingMove .5s linear infinite; animation: loadingMove .5s linear infinite; -webkit-transition: 1s; transition: 1s;}

/*进度条运动*/
@keyframes loadingMove{
	0%{background-position: 0 40px;}
	100%{background-position: 0 0;}
}
@-webkit-keyframes loadingMove{
	0%{background-position: 0 40px;}
	100%{background-position: 0 0;}
}
/*页面切换淡入效果*/
@keyframes detailsFadeIn{
	0%{opacity: 0; transform: scale(0.8);}
	100%{opacity: 1; transform: scale(1);}
}
@-webkit-keyframes detailsFadeIn{
	0%{opacity: 0; -webkit-transform: scale(0.8);}
	100%{opacity: 1; -webkit-transform: scale(1);}
}
/*页面切换淡出效果*/
@keyframes detailsFadeOut{
	0%{opacity: 1; transform: scale(1); visibility: visible;}
	100%{opacity: 0; transform: scale(0.8);}
}
@-webkit-keyframes detailsFadeOut{
	0%{opacity: 1; -webkit-transform: scale(1); visibility: visible;}
	100%{opacity: 0; -webkit-transform: scale(0.8);}
}
/*接听电话的按钮的圆圈*/
@keyframes phoneAreMove{
	0%{transform: scale(1.2);}
	0%{transform: scale(0);}
}
@-webkit-keyframes phoneAreMove{
	0%{-webkit-transform: scale(1.2);}
	0%{-webkit-transform: scale(0);}
}
/*详细页切换动画--从左显示*/
@keyframes detailsLeftShow{
	0%{transform: translateZ(-200px);}
	50%{transform: translateX(-300px) scale(0.8) rotateY(-30deg);}
	100%{transform: translate(0,0) scale(1) rotateY(0);}
}
@keyframes detailsLeftShow{
	0%{-webkit-transform: translateZ(-200px);}
	50%{-webkit-transform: translateX(-300px) scale(0.8) rotateY(-30deg);}
	100%{-webkit-transform: translate(0,0) scale(1) rotateY(0);}
}
/*详细页切换动画--从右隐藏*/
@keyframes detailsRightHide{
	0%{visibility: visible;}
	50%{transform: translateX(300px) scale(0.8) rotateY(30deg);}
	100%{transform: translateZ(-200px);}
}
@-webkit-keyframes detailsRightHide{
	0%{visibility: visible;}
	50%{-webkit-transform: translateX(300px) scale(0.8) rotateY(30deg);}
	100%{-webkit-transform: translateZ(-200px);}
}
/*详细页切换动画--从右显示*/
@keyframes detailsRightShow{
	0%{transform: translateZ(-200px);}
	50%{transform: translateX(300px) scale(0.8) rotateY(30deg);}
	100%{transform: translate(0,0) scale(1) rotateY(0);}
}
@-webkit-keyframes detailsRightShow{
	0%{-webkit-transform: translateZ(-200px);}
	50%{-webkit-transform: translateX(300px) scale(0.8) rotateY(30deg);}
	100%{-webkit-transform: translate(0,0) scale(1) rotateY(0);}
}
/*详细页切换动画--从左隐藏*/
@keyframes detailsLeftHide{
	0%{visibility: visible;}
	50%{transform: translateX(-300px) scale(0.8) rotateY(-30deg);}
	100%{transform: translateZ(-200px);}
}
@-webkit-keyframes detailsLeftHide{
	0%{visibility: visible;}
	50%{-webkit-transform: translateX(-300px) scale(0.8) rotateY(-30deg);}
	100%{-webkit-transform: translateZ(-200px);}
}
/*音乐图片旋转*/
@keyframes musicMove{
	0%{transform: rotate(0);}
	100%{transform: rotate(360deg);}
}
@-webkit-keyframes musicMove{
	0%{-webkit-transform: rotate(0);}
	100%{-webkit-transform: rotate(360deg);}
}
</style>
<script src="jquery-2.1.3.min.js"></script>
<script>
$(document).on('touchmove',function(ev){
		ev.preventDefault();
	});
$(function(){
	//获取元素
	var $main = $('#main');
	var $phone = $('#phone');
	var $phoneBtn = $('#phoneBtn');
	var $phoneBtnTouch = $phoneBtn.find('.phoneBtnTouch');
	var $phoneKey = $('#phoneKeyborad');
	var $phoneKeyClose = $phoneKey.find('.phoneKeyClose');
	var $phoneHeaderText = $('#phoneHeader').find('.phoneHeaderText');

	var $message = $('#message');
	var $messageList = $('#messageList');
	var $messageText = $('#messageText');
	var $messageLi = $messageList.find('li');
	
	var $cube = $('#cube');
	var $cubeList = $('#cubeList');
	var $cubeShare = $('#cubeShare');
	var $cubeShareMark = $('#cubeShareMark');
	var $musicIcon = $('#musicIcon');
	
	var $details = $('#details');
	var $detailsList = $('#detailsList');
	var $detailsReturn = $('#detailsReturn');
	var $detailsDot = $('#detailsDot');

	var oBell = $('#bell').get(0);
	var oSay = $('#say').get(0);
	var oMusic = $('#music').get(0);

	var desW = 640;
	var desH = 1008;
	var viewHeight = $(window).height();
	var viewWidth = $(window).width();
	var iNow = 0;
	var iTop = 0;
	
	// 加载进度条
	function loading(){
		var arr = ['shareicon.jpg','phoneBg.jpg','cubeBg.jpg','cubeImg1.png','cubeImg2.png','cubeImg3.png','cubeImg4.png','cubeImg5.png','cubeImg6.png','cubeShareMark.png','cubeTip.png','detailsCanvas1.png','detailsCanvas2.png','detailsCanvas3.png','detailsCanvas4.png','detailsCanvas5.png','detailsCanvas6.png','detailText1.png','detailText2.png','detailText3.png','detailText4.png','detailText5.png','detailText6.png','phoneBtn.png','phoneKey.png','messageHead1.png','messageHead2.png','messageText.png','phoneHeadName.png'];
		var iNow = 0;
		$.each(arr,function(i,imgSrc){
			var objImg = new Image();
			objImg.src = 'img/'+imgSrc;
			objImg.onload = function(){
				
				iNow++;
				$('.loadingProgressBar').css('width',(iNow/arr.length*100) + '%');
				
			};
			objImg.onerror = function(){
				$('#loading').animate({opacity:0},function(){
					$(this).remove();
					phone.init();
				});
			};
		});
		$('.loadingProgressBar').on('transitionEnd webkitTransitionEnd',function(){					
			if(iNow == arr.length){
				$('#loading').animate({opacity:0},function(){
					$(this).remove();
					phone.init();
				});
			}
		});
	}
	// 初始化
	function init(){
		$main.css('transform','scale('+viewHeight/desH+')');
		
		var changeW =  viewWidth/viewHeight * desH;
		
		if(changeW > desW){
			changeW = desW;
		}
		$messageList.css('padding','0 '+((desW-changeW)/2)+'px');
		$messageText.css('transform','scale('+changeW/desW+')');
		$cubeShare.css('marginRight',((desW-changeW)/2)+'px');
		$detailsReturn.css('marginRight',((desW-changeW)/2)+'px');
		loading();
		cube.init();
		details.init();
	}
	// 电话广告
	var phone = (function(){
		function init(){
			oBell.play();
			bind();
		}
		function bind(){
			$phoneBtnTouch.on('touchstart',function(){
				oBell.pause();
				$phoneBtn.css('opacity',0);
				$phoneKey.css('transform','translate(0,0)');
				say();
			});
			$phoneKeyClose.on('touchstart',function(){
				phoneClose();
			});
		}
		function say(){
			oSay.play();
			$phoneHeaderText.html('00:00');
			var timer = setInterval(function(){
				$phoneHeaderText.html(change(oSay.currentTime));
				if(oSay.currentTime == oSay.duration){
					clearInterval(timer);
					phoneClose();
				}
			},1000);
		}
		function change(num){
			var num = parseInt(num);
			var iM = toDou(Math.floor(num%3600/60));
			var iS = toDou(Math.floor(num%60));
			return iM + ':' + iS;
		}
		function phoneClose(){
			oSay.pause();
			$phone.css('transform','translate(0,'+desH+'px)');
			$phone.on('transitionEnd webkitTransitionEnd',function(){
				$(this).remove();
				message.init();
			});
		}
		function toDou(n){
			if(n<10){
				return '0' + n;
			}
			else{
				return '' + n;
			}
			return n < 10 ? '0' + n : '' + n;
		}
		return {
			init : init
		}
	})();
	// phone.init();
	// 信息广告
	var message = (function(){
		function init(){
			oMusic.play();
			showText();
		}
		function showText(){
			var timer = setInterval(function(){
				$messageLi.eq(iNow).css('opacity',80).css('transform','translate(0,0)');
				if(iNow >= 3){
					iTop -= $messageLi.eq(iNow).outerHeight() - 10;
					$messageList.css('transform','translate(0,'+(iTop)+'px)' );
				}
				iNow++;
				if(iNow == $messageLi.length){
					clearInterval(timer);
					setTimeout(function(){
						messageClose();
					},2000);
				}
			},1000);
		}
		function messageClose(){
			$message.css('transform','translate(0,'+desH+'px)');
			$message.on('transitionEnd webkitTransitionEnd',function(){
				$(this).remove();
			});
		}
		return{
			init : init
		}
	})();
	// 魔方
	var cube = (function(){
		var $li = $cubeList.find('li');
		var downX = 0;
		var downY = 0;
		var startX = -45;
		var startY = 45;
		var step = 1/2;
		var x = 0;
		var y = 0;
		var iBtn = true;
		var onoff = true;
		
		function init(){
			$cubeList.css('transform','scale(0.7) rotateX('+(startX)+'deg) rotateY('+(startY)+'deg)');
			$cubeList.css('transition','1s');
			$cubeList.on('transitionEnd webkitTransitionEnd',function(){
				$cubeList.css('transition','');
			});
			$musicIcon.attr('class','active');
			bind();
		}
		function bind(){
			$(document).on('touchstart',function(ev){
				var touch = ev.originalEvent.changedTouches[0];
				downX = touch.pageX;
				downY = touch.pageY;
				iBtn = true;
				$(document).on('touchmove.move',function(ev){
					var touch = ev.originalEvent.changedTouches[0];
					iBtn = false;
					x = (downY - touch.pageY) * step;
					y = (touch.pageX - downX) * step;

					if(startX + x > 80){
						x = -startX + 80; 
					}else if(startX + x < -80){
						x = -startX - 80;
					}

					$cubeList.css('transform','scale(0.7) rotateX('+(startX+x)+'deg) rotateY('+(startY+y)+'deg)');
				});
				$(document).on('touchend.move',function(){
					$(document).off('.move');
				});
			});
			
			$li.on('touchend',function(){
				if(iBtn){  //点击
					//alert( $(this).index() );
					details.show( $(this).index() );
				}
				else{  //拖拽
					startX += x;
					startY += y;
				}
			});
			$cubeShare.on('touchstart',function(){
				$cubeShareMark.show();
				$musicIcon.hide();
			});
			$cubeShareMark.on('touchstart',function(){
				$(this).hide();
				$musicIcon.show();
			});
			$musicIcon.on('touchstart',function(){
				if(onoff){
					oMusic.pause();
					$(this).attr('class','');
				}else{
					oMusic.play();
					$(this).attr('class','active');
				}
				onoff = !onoff;
			});
		}
		return {
			init : init
		}
	})();
	// 点击魔方后显示的详细信息
	var details = (function(){
		var $li1 = $detailsList.find('li');
		var $listDot = $detailsDot.find('span');
		var $detailsImg = $detailsList.find('.detailsImg');
		var iNow = 0;
		
		function init(){
			bind();
		}
		
		function bind(){
			var downX = 0;
			var nowIndex = 0;
			var prevornextIndex = 0;
			$li1.on('touchstart',function(ev){
				var touch = ev.originalEvent.changedTouches[0];
				downX = touch.pageX;
				nowIndex = $(this).index();

				$li1.on('touchend',function(ev){
					var touch = ev.originalEvent.changedTouches[0];
					if(touch.pageX < downX){ //→
						
						prevornextIndex = nowIndex == $li1.length-1 ? 0 : nowIndex + 1;
						$(this).attr('class','leftHide');
						$li1.eq(prevornextIndex).attr('class','rightShow');

					}else if(touch.pageX > downX){ //←
						
						prevornextIndex = nowIndex == 0 ? $li1.length-1 : nowIndex - 1;
						$(this).attr('class','rightHide');
						$li1.eq(prevornextIndex).attr('class','leftShow');

					}
					$li1.off('touchend');
					$listDot.eq(prevornextIndex).attr('class','active').siblings().attr('class','');
					iNow = prevornextIndex;
					bindCanvas(prevornextIndex);
				});
			});

			$detailsReturn.on('touchstart',function(){
				hide(iNow);
			});
		}
		function show(index){
			$cube.hide();
			$details.show();
			$li1.eq(index).attr('class','fadeIn');
			$listDot.eq(index).attr('class','active');
			iNow = index;
			bindCanvas(index);
		}
		function hide(index){
			
			$li1.eq(index).attr('class','fadeOut');
			$li1.eq(index).one('animationEnd webkitAnimationEnd',function(){
				$cube.show();
				$details.hide();
				$li1.attr('class','');
				$listDot.attr('class','');
			});
		}
		function bindCanvas(index){
			var $img = $detailsImg.eq(index).find('img');
			var oC = $detailsImg.eq(index).find('canvas').get(0);
			var oGc = oC.getContext('2d');
			var objImg = new Image();
			objImg.src = $img.attr('src');
			$img.animate({opacity : 0},1000);
			objImg.onload = function(){
				
				oGc.drawImage(objImg,0,0);
				var dataImg = oGc.getImageData(0,0,oC.width,oC.height);
				oGc.clearRect(0,0,oC.width,oC.height);
				var step = 10;
				var arrPx = [];
				var stepW = parseInt(dataImg.width/step);
				var stepH = parseInt(dataImg.height/step);

				for (var i = 0; i < stepH; i++) {
					for (var j = 0; j < stepW; j++) {
						var color = getColor(dataImg,j*step,i*step);
						if(color != 0){
							arrPx.push( { x : j*step, y : i*step, rdmX : Math.random()*oC.width, rdmY : Math.random()*oC.height } );
						}
					};
				};
				for (var i = 0; i < arrPx.length; i++) {
					oGc.beginPath();
					oGc.arc(arrPx[i].rdmX,arrPx[i].rdmY,1,0,360*Math.PI/180);
					oGc.closePath();
					oGc.fill();
				};
				setTimeout(function(){
					move(arrPx);
				},1000);
			}
			function getColor(dataImg,x,y){
				var w = dataImg.width;
				var h = dataImg.height;
				var d = dataImg.data;
				return d[(y*w+x)*4+3];
			}
			function move(arr){
				var maxTime = 500;
				var startTime = nowTime();
				var timer = setInterval(function(){
					var changeTime = nowTime();
					oGc.clearRect(0,0,oC.width,oC.height);
					var t = Math.min(changeTime-startTime,maxTime);
					
					for (var i = 0; i < arr.length; i++) {
						var nowX = (arr[i].x - arr[i].rdmX) * t/maxTime + arr[i].rdmX;
						var nowY = (arr[i].y - arr[i].rdmY) * t/maxTime + arr[i].rdmY;

						oGc.beginPath();
						oGc.arc(nowX,nowY,1,0,360*Math.PI/180);
						oGc.closePath();
						oGc.fill();
					};
					if(t == maxTime){
						clearInterval(timer);
						setTimeout(function(){
							oGc.clearRect(0,0,oC.width,oC.height);
							$img.animate({opacity : 1},1000);
						},300);
					}

				},14);

				function nowTime(){
					return (new Date()).getTime();
				}
			}
		}
		return {
			init : init,
			show : show
		}
	})();
	
	init();

});
</script>
</head>
<body>
	<!-- 分享页面显示的默认图片，尺寸需要500px意思 -->
	<div style="display:none"><img src="img/shareicon.jpg" height="200" width="200" alt=""></div>
	<div id="main">
		<div id="loading">
			<div class="loadingProgressBox">
				<div class="loadingProgressBar"></div>
			</div>
		</div>
		<div id="audi">
			<!-- <audio id="bell" src="img/bell.mp3" preload="auto" loop ></audio> -->
			<audio id="bell" >
				<source src="http://www.ikoumi.com/yunpan/cFZbnrVsIFWTn/ec8b.mp3" type="audio/mp3"></source>
				<source src="img/bell.mp3" type="audio/mp3"></source>
			</audio>
			
			<audio id="say" preload="auto" >
				<source src="http://www.ikoumi.com/yunpan/cFZbMetNMkH4v/ee2e.mp3" type="audio/mp3"></source>
				<source src="img/say.mp3" type="audio/mp3"></source>
			</audio>
			<audio id="music" preload="auto" >
				<source src="http://www.ikoumi.com/yunpan/cFZbNY3zw4ce2/8309.mp3" type="audio/mp3"></source>
				<source src="img/music.mp3" type="audio/mp3"></source>
			</audio>
		</div>
		<div id="phone">
			<div id="phoneHeader">
				<div class="phoneHeadBtn"></div>
				<div class="phoneHeaderText"></div>
			</div>
			<div id="phoneBtn">
				<div class="phoneBtnArc"></div>
				<div class="phoneBtnTouch"></div>
			</div>
			<div id="phoneKeyborad">
				<div class="phoneKeyClose"></div>
			</div>
		</div>
		<div id="message">
			<ul id="messageList">
				<li class="sty1">
	            	<img src="img/messageHead1.png">
	                那个谁谁谁……
	            </li>
	            <li class="sty2">
	            	<img src="img/messageHead2.png">
	                你好，我是妙味课堂，小乐～ ^_^
	            </li>
	            <li class="sty1">
	            	<img src="img/messageHead1.png">
	                哦，小乐乐你好！
	            </li>
	            <li class="sty2">
	            	<img src="img/messageHead2.png">
	                嗯，请问有什么可以帮到你？
	            </li>
	            <li class="sty1">
	            	<img src="img/messageHead1.png">
	                你们那个移动端课程都讲到什么？
	            </li>
	            <li class="sty2">
	            	<img src="img/messageHead2.png">
	                我们这次的移动端课程，讲的是移动端H5场景应用的相关知识，比如：CSS3D、canvas、粒子、动画……
	            </li>
	            <li class="sty1">
	            	<img src="img/messageHead1.png">
	                那你们上课的时间是什么？
	            </li>
	            <li class="sty1">
	            	<img src="img/messageHead1.png">
	                你们这个课程是谁来讲？？
	            </li>
	            <li class="sty1">
	            	<img src="img/messageHead1.png">
	                这个课程学完以后能自己做移动端吗？
	            </li>
	            <li class="sty1">
	            	<img src="img/messageHead1.png">
	                这个学费多钱？贵吗？
	            </li>
	            <li class="sty1">
	            	<img src="img/messageHead1.png">
	                哦对了，我基础不太好听得懂吗？
	            </li>
	            <li class="sty1">
	            	<img src="img/messageHead1.png">
	                嗯？小乐乐？在吗？？？
	            </li>
	            <li class="sty2">
	            	<img src="img/messageHead2.png">
	                呃……是的，我一直都在，我正在拼命打字回复你的问题，只是回复慢了，请见谅啊。另外，你的问题比较多，我干脆送给你一个神奇魔方，让这个精致的小魔方来回复你所有问题吧？
	            </li>
	            <li class="sty1">
	            	<img src="img/messageHead1.png">
	                啊？魔方？什么鬼东东？
	            </li>
	            <li class="sty2">
	            	<img src="img/messageHead2.png">
	                嘻嘻……发给你了，接住啊~~
	            </li>
			</ul>
			<div id="messageText"></div>
		</div>
		<div id="cube">
			<div id="musicIcon"></div>
			<ul id="cubeList">
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
			</ul>
			<div id="cubeTip"></div>
			<div id="cubeShare"></div>
			<div id="cubeShareMark"><img src="img/cubeShareMark.png" height="484" width="456" alt=""></div>
		</div>
		<div id="details">
			<ul id="detailsList">
				<li>
					<div class="detailsImg">
						<img src="img/detailsCanvas1.png" alt="">
						<canvas height="423" width="510" ></canvas>
					</div>
					<div class="detailsText"></div>
				</li>
				<li>
					<div class="detailsImg">
						<img src="img/detailsCanvas2.png" alt="">
						<canvas height="374" width="374"></canvas>
					</div>
					<div class="detailsText"></div>
				</li>
				<li>
					<div class="detailsImg">
						<img src="img/detailsCanvas3.png" alt="">
						<canvas height="336" width="386"></canvas>
					</div>
					<div class="detailsText"></div>
				</li>
				<li>
					<div class="detailsImg">
						<img src="img/detailsCanvas4.png" alt="">
						<canvas height="306" width="259"></canvas>
					</div>
					<div class="detailsText"></div>
				</li>
				<li>
					<div class="detailsImg">
						<img src="img/detailsCanvas5.png" alt="">
						<canvas height="284" width="221"></canvas>
					</div>
					<div class="detailsText"></div>
				</li>
				<li>
					<div class="detailsImg">
						<img src="img/detailsCanvas6.png" alt="">
						<canvas height="419" width="478" ></canvas>
					</div>
					<div class="detailsText"></div>
				</li>
			</ul>
			<div id="detailsDot">
				<span></span>
				<span></span>
				<span></span>
				<span></span>
				<span></span>
				<span></span>
			</div>
			<div id="detailsReturn"></div>
		</div>
	</div>
</body>
</html>